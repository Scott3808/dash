# =============================================================================
# Dash Local Stack â€” Ollama + SQL Server + pgvector
# =============================================================================
#
# Usage:
#   docker compose up -d          # Start pgvector (agent DB)
#   python -m dash                # CLI mode (connects to Ollama + SQL Server on host)
#   python -m dash.agents         # Quick test
#
# Prerequisites on Windows host:
#   - Ollama running at http://localhost:11434 with qwen3:14b pulled
#   - SQL Server instance with mshist database accessible via Windows Auth
#
# =============================================================================

services:
  # Agent state & vector storage (knowledge, learnings, chat history)
  dash-db:
    image: agnohq/pgvector:18
    container_name: dash-db
    restart: unless-stopped
    ports:
      - "${AGENT_DB_PORT:-5532}:5432"
    volumes:
      - pgdata:/var/lib/postgresql
    environment:
      POSTGRES_USER: ${AGENT_DB_USER:-ai}
      POSTGRES_PASSWORD: ${AGENT_DB_PASS:-ai}
      POSTGRES_DB: ${AGENT_DB_DATABASE:-dash}
    networks:
      - dash

networks:
  dash:

volumes:
  pgdata:
